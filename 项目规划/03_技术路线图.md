# Aiden-Lite 技术路线图 (Roadmap)

## 项目分阶段实现计划

## 阶段 0: 项目基础设施 (第 1-2 周)

### 0.1 项目初始化
- [x] 创建 Git 仓库
- [ ] 搭建基础目录结构
- [ ] 配置 Python 开发环境
- [ ] 设置 requirements.txt
- [ ] 编写 .gitignore 和 .env 模板

### 0.2 基础框架搭建
- [ ] 初始化 FastAPI 项目
- [ ] 配置日志系统 (loguru)
- [ ] 设置配置管理 (Pydantic Settings)
- [ ] 创建基础数据库连接
- [ ] 编写项目初始化脚本

### 0.3 开发工具配置
- [ ] Pre-commit hooks (代码格式化)
- [ ] CI/CD 流程 (GitHub Actions)
- [ ] 文档生成工具

**预计周期**: 1-2 周
**交付物**: 可运行的基础框架

---

## 阶段 1: AI 对话核心 (第 3-10 周) ⭐

### 1.1 语音处理 (第 3-4 周)
- [ ] **ASR 模块**
  - 集成 faster-whisper (本地语音识别)
  - 支持多语言 (中文/英文)
  - 实时流式识别
  - 性能优化 (量化模型)
  
- [ ] **TTS 模块**
  - 集成 edge-tts (微软高质量语音)
  - 支持语调/速度控制
  - 缓存生成的音频
  - 支持多种语言

- [ ] **音频处理**
  - 麦克风输入采集
  - 扬声器输出控制
  - 噪声抑制
  - 音量自适应

**验收标准**: 能从麦克风输入语音并识别，能将文本转语音播放

### 1.2 大模型集成 (第 5-6 周)
- [ ] **LLM 客户端**
  - OpenAI API 集成
  - 支持 GPT-3.5 / GPT-4
  - 备选方案集成 (文心一言/Claude)
  
- [ ] **Prompt 工程**
  - 设计系统 prompt (定义 AI 性格)
  - 角色扮演模板
  - 指令模板库
  
- [ ] **Token 管理**
  - Token 计数 (tiktoken)
  - 成本估算
  - 会话管理

**验收标准**: 能正常调用大模型 API 并生成合理回复

### 1.3 对话管理系统 (第 7-8 周)
- [ ] **对话管理器**
  - 多轮对话状态机
  - 对话历史存储
  - 会话生命周期管理
  
- [ ] **记忆系统**
  - 对话历史记录 DB
  - 长期记忆 (用户偏好、重要信息)
  - 短期记忆 (上下文窗口)
  
- [ ] **上下文管理**
  - 动态上下文构建
  - 相关信息检索
  - 记忆去重

- [ ] **唤醒词检测**
  - 本地轻量级唤醒词模型
  - 支持自定义唤醒词
  - 低误触发

**验收标准**: 实现 3-5 轮自然连续对话，具有上下文理解

### 1.4 集成测试 (第 9-10 周)
- [ ] 端到端流程测试
- [ ] 性能基准测试
- [ ] 用户体验优化

**交付物**: 可独立运行的 AI 对话系统

---

## 阶段 2: 人脸识别系统 (第 11-15 周)

### 2.1 基础人脸检测 (第 11-12 周)
- [ ] **摄像头模块**
  - USB 摄像头驱动
  - IP 摄像头支持
  - 多摄像头支持
  - 实时视频流
  
- [ ] **人脸检测**
  - OpenCV 人脸检测
  - MediaPipe 高精度检测
  - 人脸质量评估
  - 性能优化

**验收标准**: 能实时检测摄像头中的人脸并显示

### 2.2 人脸识别 (第 13-14 周)
- [ ] **人脸识别引擎**
  - face_recognition 库集成
  - 人脸特征提取
  - 1:1 识别与 1:N 搜索
  
- [ ] **人员数据库**
  - 人脸编码存储
  - 人脸库管理 (增删改查)
  - 相似度匹配算法
  
- [ ] **识别优化**
  - 多人脸识别
  - 遮挡处理
  - 角度补偿

**验收标准**: 能准确识别已注册的人脸

### 2.3 个性化问候 (第 15 周)
- [ ] **用户信息库**
  - 人员基础信息表
  - 关系/称谓信息
  - 职业等扩展信息
  
- [ ] **问候生成**
  - 基于身份的个性化问候
  - 与大模型联动生成自然问候
  - 情景化问候模板

**交付物**: 人脸识别 → 个性化问候系统

---

## 阶段 3: 日程管理系统 (第 16-22 周)

### 3.1 日程解析 (第 16-17 周)
- [ ] **NLU 日程识别**
  - 从对话中提取时间实体
  - 提取事件/活动名称
  - 提取地点、参与人等
  
- [ ] **时间规范化**
  - 相对时间转绝对时间
  - 时区处理
  - 重复规则解析 (日/周/月)

**验收标准**: 能从语句如"明天上午10点开会"提取结构化信息

### 3.2 日程管理 (第 18-19 周)
- [ ] **日程数据库**
  - 日程存储表设计
  - 日程查询接口
  - 冲突检测
  
- [ ] **日程操作**
  - 创建/更新/删除日程
  - 日程检索与筛选
  - 日程导入/导出 (iCal 格式)

**验收标准**: 能存储和检索日程

### 3.3 日程提醒 (第 20-21 周)
- [ ] **智能提醒引擎**
  - 基于时间的定时提醒
  - 基于人脸识别的即时提醒
  - 多个提醒时间点
  
- [ ] **提醒策略**
  - 提前 1 小时/30 分钟提醒
  - 到时提醒
  - 已过期提醒
  
- [ ] **提醒内容生成**
  - 根据日程内容生成提醒文案
  - 与大模型联动优化文案

**验收标准**: 能准时触发提醒并自然播报

### 3.4 日程优化 (第 22 周)
- [ ] **智能规划**
  - 日程碎片整理
  - 行程路线优化
  - 工作时间分析

**交付物**: 完整的日程管理系统

---

## 阶段 4: 设备联动系统 (第 23-30 周)

### 4.1 MQTT 基础 (第 23-24 周)
- [ ] **MQTT 客户端**
  - paho-mqtt 集成
  - 自动重连
  - TLS 加密支持
  
- [ ] **设备网关**
  - 本地 Mosquitto Broker 搭建
  - 设备注册/发现
  - 设备状态管理

**验收标准**: 能连接 MQTT broker 并发布/订阅消息

### 4.2 智能设备控制 (第 25-26 周)
- [ ] **通用指令执行**
  - 开/关灯
  - 调节温度
  - 打开窗帘
  - 播放音乐
  
- [ ] **场景管理**
  - 场景定义 (出门模式、回家模式等)
  - 一键执行场景
  - 场景编辑器

**验收标准**: 能通过语音控制简单设备

### 4.3 米家生态集成 (第 27-29 周)
- [ ] **米家 API 集成**
  - 开放平台 SDK 集成
  - 设备发现与同步
  - 设备状态查询
  
- [ ] **米家设备控制**
  - 支持主流米家设备
  - 场景联动
  - 自动化规则
  
- [ ] **房间/设备信息**
  - 获取房间列表
  - 获取房间内设备
  - 设备分类展示

**验收标准**: 能调用米家设备，获取房间信息

### 4.4 高级功能 (第 30 周)
- [ ] **场景自动化**
  - 基于时间的自动化
  - 基于条件的自动化 (温度、光线等)
  - 场景优先级管理

**交付物**: 完整的设备联动系统

---

## 阶段 5: 高级功能 & 优化 (第 31-36 周)

### 5.1 小爱同学集成 (第 31-32 周)
- [ ] **需求分析**
  - 识别何时需要调用小爱
  - 提取小爱需要的参数
  
- [ ] **小爱调用**
  - 与小爱设备通信
  - 指令转发
  - 结果反馈

### 5.2 MCP 接口扩展 (第 33-34 周)
- [ ] **MCP 服务器实现**
  - 标准工具定义
  - 参数验证
  - 错误处理
  
- [ ] **第三方集成**
  - 数据库查询工具
  - 自定义命令工具
  - 外部 API 调用工具

### 5.3 性能优化 (第 35 周)
- [ ] 推理加速 (GPU/ONNX)
- [ ] 内存优化
- [ ] 响应时间优化

### 5.4 安全加固 (第 36 周)
- [ ] 数据加密
- [ ] API 权限管理
- [ ] 隐私保护
- [ ] 安全审计

**交付物**: 完整的功能版本

---

## 阶段 6: 测试、文档与发布 (第 37-40 周)

### 6.1 全面测试
- [ ] 单元测试覆盖
- [ ] 集成测试
- [ ] 性能测试
- [ ] 用户验收测试

### 6.2 文档完善
- [ ] API 文档
- [ ] 部署指南
- [ ] 用户手册
- [ ] 开发者文档

### 6.3 发布与部署
- [ ] Docker 镜像打包
- [ ] 一键安装脚本
- [ ] 首次发布 (v0.1.0)

---

## 优先级与关键路径

**第一优先级 (MVP 核心)**: 阶段 1 + 2 (8 周)
- AI 对话基础功能
- 人脸识别与问候

**第二优先级**: 阶段 3 (7 周)
- 日程管理与提醒

**第三优先级**: 阶段 4 (8 周)
- 设备联动

**可选**: 阶段 5-6 (10+ 周)
- 高级功能与优化

## 风险与缓解措施

| 风险 | 概率 | 影响 | 缓解措施 |
|------|------|------|---------|
| 大模型 API 费用高 | 中 | 中 | 使用本地开源模型、缓存 |
| 人脸识别精度不足 | 低 | 中 | 采用多模型融合、阈值调整 |
| MQTT/米家集成复杂 | 中 | 中 | 提前研究 API、预留时间 |
| 硬件不足 | 低 | 高 | 优化模型、选择轻量级方案 |
| 跨平台兼容性 | 中 | 低 | 早期测试、使用跨平台库 |

